---
description:å½“ç”¨æˆ·è¾“å…¥/updateå‘½ä»¤æ—¶,æ‰§è¡Œå¼€å‘çŠ¶æ€æ›´æ–°å‘½ä»¤
globs:
alwaysApply: false
---

# VibeCopilot å¼€å‘çŠ¶æ€æ›´æ–°å‘½ä»¤å¤„ç†å™¨

## å…³é”®è§„åˆ™

- å½“ç”¨æˆ·è¾“å…¥`/update`å‘½ä»¤æ—¶ï¼Œæ›´æ–°å¼€å‘å¯¹è±¡çš„çŠ¶æ€ã€è¿›åº¦æˆ–ç›¸å…³ä¿¡æ¯
- å¿…é¡»æŒ‡å®šè¦æ›´æ–°çš„å¯¹è±¡IDæˆ–æ›´æ–°ç±»å‹
- æ”¯æŒæ›´æ–°çŠ¶æ€å’Œè¿›åº¦ç™¾åˆ†æ¯”ï¼Œè‡ªåŠ¨è®°å½•åˆ°å¼€å‘æ—¥å¿—
- è‡ªåŠ¨æ›´æ–°ç›¸å…³è”å¯¹è±¡ï¼Œæä¾›æ¸…æ™°åé¦ˆ
- æ”¯æŒä¸GitHubé¡¹ç›®å’Œæœ¬åœ°æ•…äº‹æ¿åŒå‘åŒæ­¥

## æ¦‚å¿µæ˜ å°„å…³ç³»

```mermaid
graph TD
    Epic[Epic] --> Story[Story]
    Story --> Task[Task]

    RoadmapTask[".ai/roadmap/"] <-.-> Story
    GitHubIssue["GitHub Issue"] <-.-> Task
    GitHubMilestone["GitHub Milestone"] <-.-> Epic

    classDef local fill:#e1f5fe,stroke:#01579b
    classDef remote fill:#fce4ec,stroke:#c2185b

    class Epic,Story,Task local
    class GitHubIssue,GitHubMilestone,RoadmapTask remote
```

- **Epic**: `.ai/epics/`ç›®å½•ï¼Œæ˜ å°„åˆ°è·¯çº¿å›¾milestoneå’ŒGitHub milestone
- **Story**: `.ai/stories/`ç›®å½•ï¼Œæ˜ å°„åˆ°è·¯çº¿å›¾taskå’ŒGitHubé‡Œç¨‹ç¢‘ä»»åŠ¡
- **Task**: `.ai/tasks/`ç›®å½•ï¼Œæ˜ å°„åˆ°è·¯çº¿å›¾å…·ä½“ä»»åŠ¡å’ŒGitHub issue

## å‘½ä»¤æ ¼å¼è§„èŒƒ

### å¯¹è±¡çŠ¶æ€æ›´æ–°å‘½ä»¤
```
/update --id=<å¯¹è±¡ID> [--status=<æ–°çŠ¶æ€>] [--progress=<ç™¾åˆ†æ¯”>] [--note=<è¯´æ˜>] [--github]
```

å‚æ•°è¯´æ˜:
- `--id`: å¿…é€‰ï¼Œå¯¹è±¡ID (task-001/story-002/epic-001)
- `--status`: å¯¹è±¡æ–°çŠ¶æ€
  - Epic: planned/in-progress/completed/cancelled
  - Story: draft/ready/in-progress/review/completed
  - Task: todo/in-progress/completed/blocked
- `--progress`: è¿›åº¦ç™¾åˆ†æ¯”(0-100)
- `--note`: æ›´æ–°è¯´æ˜
- `--github`: æ˜¯å¦åŒæ­¥åˆ°GitHub

### è·¯çº¿å›¾æ›´æ–°å‘½ä»¤
```
/update roadmap [--init] [--check] [--sync-stories] [--sync-github] [--direction=<æ–¹å‘>]
```

å‚æ•°è¯´æ˜:
- æ— å‚æ•°: æ£€æŸ¥storyè¿›åº¦ä¸€è‡´æ€§ï¼ŒåŒæ­¥è·¯çº¿å›¾
- `--init`: åˆå§‹åŒ–è·¯çº¿å›¾ï¼Œä½¿ç”¨base.yamlæ–°ç»“æ„
- `--check`: åŸºäºgitæäº¤å†å²åˆ†æè¿›åº¦å¹¶æ›´æ–°
- `--sync-stories`: æ•…äº‹æ¿ä¸è·¯çº¿å›¾åŒå‘åŒæ­¥
- `--sync-github`: ä¸GitHubé¡¹ç›®ç®¡ç†åŒæ­¥
- `--direction`: åŒæ­¥æ–¹å‘(to-github/from-github/to-stories/from-stories)

### å‘½ä»¤å®ç°æœºåˆ¶

å‘½ä»¤å®é™…æ‰§è¡Œé‡‡ç”¨ä»¥ä¸‹æœºåˆ¶ï¼š

1. **å¯¹è±¡çŠ¶æ€æ›´æ–°**:
   - å®ç°è„šæœ¬: `src/cli/commands/update_status.py`
   - GitHubåŒæ­¥: å½“æ·»åŠ `--github`å‚æ•°æ—¶ï¼Œä¼šè°ƒç”¨`src/github/roadmap/sync_github.py`

2. **è·¯çº¿å›¾æ›´æ–°**:
   - åŸºæœ¬æ›´æ–°: `src/cli/commands/update_roadmap.py`
   - Gitåˆ†æ: `src/cli/commands/analyze_git.py`
   - æ•…äº‹æ¿åŒæ­¥: `src/cli/commands/sync_stories.py`
   - GitHubåŒæ­¥: `src/github/roadmap/sync_github.py`

å‘½ä»¤ä¼šæ£€æŸ¥å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼ŒåŒ…æ‹¬ï¼š
- `GITHUB_TOKEN`: GitHubè®¿é—®ä»¤ç‰Œï¼Œç”¨äºè®¿é—®GitHub API
- `GITHUB_OWNER`: GitHubä»“åº“æ‰€æœ‰è€…
- `GITHUB_REPO`: GitHubä»“åº“åç§°

å¦‚éœ€å¯ç”¨GitHubåŒæ­¥åŠŸèƒ½ï¼Œè¯·ç¡®ä¿åœ¨`.env`æ–‡ä»¶ä¸­é…ç½®ä»¥ä¸Šç¯å¢ƒå˜é‡ã€‚

## æ ¸å¿ƒå·¥ä½œæµç¨‹

```mermaid
flowchart TD
    A[å¼€å§‹] --> B[éªŒè¯è¯·æ±‚]
    B --> C[æ‰§è¡Œæ›´æ–°]
    C --> D[çº§è”æ›´æ–°]
    D --> E[åŒæ­¥å­˜å‚¨]
    E --> F1{åŒæ­¥æ•…äº‹æ¿?}
    F1 -->|æ˜¯| F2[æ•…äº‹æ¿åŒæ­¥]
    F1 -->|å¦| G1{åŒæ­¥GitHub?}
    F2 --> G1
    G1 -->|æ˜¯| G2[GitHubåŒæ­¥]
    G1 -->|å¦| H[æ˜¾ç¤ºç»“æœ]
    G2 --> H
```

## åŒæ­¥æœºåˆ¶

### æ•…äº‹æ¿åŒæ­¥
- **æ˜ å°„è§„åˆ™**:
  - StoryçŠ¶æ€æ˜ å°„åˆ°è·¯çº¿å›¾taskçŠ¶æ€
  - è·¯çº¿å›¾è¿›åº¦åé¦ˆåˆ°Story
- **å†²çªè§£å†³**: æœ¬åœ°ä¼˜å…ˆï¼Œè‡ªåŠ¨æ›´æ–°æ¬¡ä¹‹ï¼Œè¿œç¨‹æœ€å
- **åŒæ­¥æ–¹å‘**: æ”¯æŒåŒå‘ã€å•å‘æ•…äº‹åˆ°è·¯çº¿å›¾ã€å•å‘è·¯çº¿å›¾åˆ°æ•…äº‹

### GitHubåŒæ­¥
- **æ˜ å°„è§„åˆ™**:
  - Task â†’ GitHub Issue
  - Story â†’ GitHub Task
  - Epic â†’ GitHub Milestone
- **æ•°æ®æ˜ å°„**: çŠ¶æ€ã€æ ‡ç­¾ã€å®Œæˆåº¦åŒå‘åŒæ­¥
- **æƒé™æ§åˆ¶**: éœ€è¦æœ‰æ•ˆGitHub Token

## åé¦ˆæ ¼å¼ç¤ºä¾‹

### ä»»åŠ¡æ›´æ–°
```
âœ… ä»»åŠ¡æ›´æ–°æˆåŠŸ!
task-004 "åˆ†æ”¯ç®¡ç†è‡ªåŠ¨åŒ–" å·²æ ‡è®°ä¸ºå·²å®Œæˆ
æ‰€å±æ•…äº‹è¿›åº¦: 80% (â†‘20%)
[åŒæ­¥]: å·²åŒæ­¥åˆ°æ•…äº‹æ¿å’ŒGitHub Issue #24
```

### è·¯çº¿å›¾æ›´æ–° (æ£€æŸ¥)
```
ğŸ“Š è·¯çº¿å›¾æ£€æŸ¥å®Œæˆ!
åˆ†æäº†30å¤©154æ¬¡æäº¤ï¼Œè¯†åˆ«4ä¸ªåŠŸèƒ½æ¨¡å—å˜æ›´ï¼Œå‘ç°5ä¸ªå·²å®Œæˆä»»åŠ¡
æ›´æ–°å†…å®¹:
- GitDiagramé›†æˆ: 100% âœ…
- å‘½ä»¤ç³»ç»Ÿ: 65% ğŸš§
- çŸ¥è¯†åº“ç®¡ç†: 0% ğŸ“
[è¿›åº¦æŠ¥å‘Š]: .ai/reports/progress.md
```

### è·¯çº¿å›¾åŒæ­¥
```
ğŸ”„ åŒæ­¥å®Œæˆ! å¤„ç†12ä¸ªæ•…äº‹/15ä¸ªä»»åŠ¡/8ä¸ªGitHub Issue
- æ›´æ–°: 3ä¸ªæ•…äº‹çŠ¶æ€ï¼Œ5ä¸ªä»»åŠ¡è¿›åº¦ï¼Œ4ä¸ªGitHub Issue
- åˆ›å»º: 2ä¸ªæ–°æ•…äº‹æ–‡ä»¶ï¼Œ1ä¸ªæ–°è·¯çº¿å›¾ä»»åŠ¡
- è§£å†³: 2ä¸ªçŠ¶æ€å†²çª
[æ—¥å¿—]: .ai/logs/sync_2023-04-05.log
```

## æ•°æ®æºä¸å®ç°

### æ•°æ®æº
- `.ai/{epics|stories|tasks}/`: æœ¬åœ°å¯¹è±¡å­˜å‚¨
- `.ai/roadmap/`: è·¯çº¿å›¾é…ç½®ä¸å½“å‰çŠ¶æ€
- `.ai/reports/`: ç”Ÿæˆçš„è¿›åº¦æŠ¥å‘Š
- GitHub API: è¿œç¨‹é¡¹ç›®ç®¡ç†

### æ ¸å¿ƒåŠŸèƒ½
- çŠ¶æ€éªŒè¯ä¸è¿›åº¦è®¡ç®—
- Gitå†å²åˆ†æä¸è¿›åº¦è¯†åˆ«
- å¤šæ–¹å‘åŒæ­¥ä¸å†²çªè§£å†³
- æ™ºèƒ½çŠ¶æ€è½¬æ¢ä¸æ¨è

## ç¤ºä¾‹

<example>
  ç”¨æˆ·: `/update --id=task-004 --status=completed --note="å®Œæˆåˆ†æ”¯ç®¡ç†" --github`

  ç³»ç»Ÿå“åº”:
  ```
  âœ… ä»»åŠ¡æ›´æ–°æˆåŠŸ!
  task-004 "åˆ†æ”¯ç®¡ç†è‡ªåŠ¨åŒ–" å·²æ ‡è®°ä¸ºå·²å®Œæˆ
  æ‰€å±æ•…äº‹ story-002 è¿›åº¦: 80% (â†‘20%)
  [åŒæ­¥]: å·²åŒæ­¥åˆ°GitHub Issue #24
  ```

  ç”¨æˆ·: `/update roadmap --check`

  ç³»ç»Ÿå“åº”:
  ```
  ğŸ“Š è·¯çº¿å›¾æ£€æŸ¥å®Œæˆ!
  åˆ†æ30å¤©112æ¬¡æäº¤ï¼Œè¯†åˆ«4ä¸ªæ¨¡å—å˜æ›´ï¼Œ3ä¸ªæœªæ›´æ–°ä»»åŠ¡
  æ›´æ–°å†…å®¹:
  - GitDiagramé›†æˆ: 100% âœ…
  - å‘½ä»¤ç³»ç»Ÿå¼€å‘: 65% ğŸš§
  - çŸ¥è¯†åº“ç®¡ç†: 0% ğŸ“
  [è¿›åº¦æŠ¥å‘Š]: .ai/reports/progress.md
  ```

  ç”¨æˆ·: `/update roadmap --sync-stories --sync-github`

  ç³»ç»Ÿå“åº”:
  ```
  ğŸ”„ åŒæ­¥å®Œæˆ! å¤„ç†8ä¸ªæ•…äº‹/12ä¸ªä»»åŠ¡/5ä¸ªGitHub Issue
  - æ›´æ–°: 2ä¸ªæ•…äº‹çŠ¶æ€ï¼Œ4ä¸ªä»»åŠ¡è¿›åº¦ï¼Œ3ä¸ªGitHub Issue
  - åˆ›å»º: 1ä¸ªæ–°æ•…äº‹æ–‡ä»¶
  - è§£å†³: 1ä¸ªçŠ¶æ€å†²çª
  [æ—¥å¿—]: .ai/logs/sync_2023-04-05.log
  ```
</example>

<example type="invalid">
  ç”¨æˆ·: `/update --id=task-004 --status=completed`
  ç³»ç»Ÿå“åº”: `ä»»åŠ¡å·²æ›´æ–°`
  é—®é¢˜: åé¦ˆè¿‡äºç®€å•ï¼Œç¼ºä¹è¯¦ç»†ä¿¡æ¯å’Œä¸Šä¸‹æ–‡

  ç”¨æˆ·: `/update roadmap`
  ç³»ç»Ÿå“åº”: `æ­£åœ¨æ›´æ–°roadmap.yaml...å®Œæˆ`
  é—®é¢˜: æœªæä¾›æ˜ç¡®ä¿¡æ¯ï¼Œç¼ºå°‘å˜æ›´è¯¦æƒ…å’ŒåŒæ­¥çŠ¶æ€
</example>
