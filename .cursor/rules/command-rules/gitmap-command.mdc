---
description: 当用户输入/gitmap命令时,使用GitDiagram分析项目结构并生成架构图
globs:
alwaysApply: false
---

# VibeCopilot GitMap命令

## 核心规则

- 当用户输入`/gitmap`或相关命令时，提供项目架构分析服务
- 使用scripts/gitdiagram下的工具进行项目分析和可视化
- 支持自定义参数，如项目路径、分析指令和输出路径
- 清晰解释各选项的作用及推荐用法
- 提供分析结果的可视化和解释
- 完成分析后保存结果并提供明确的后续步骤

## 命令格式

```
/gitmap [选项] [项目路径]
```

### 支持的选项

- `-h, --help`: 显示帮助信息
- `-o, --output DIR`: 指定输出目录
- `-i, --instructions TEXT`: 自定义分析指令
- `-k, --key KEY`: 指定OpenAI API密钥
- `-r, --refactor`: 重构模式，用于已重构项目的分析

## 使用场景

1. **新项目分析**：`/gitmap <项目路径>` - 分析项目结构并生成架构图
2. **重构后分析**：`/gitmap -r <项目路径>` - 分析重构后的项目，更新路线图
3. **自定义分析**：`/gitmap -i "关注数据流" <项目路径>` - 根据特定指令分析项目
4. **查看帮助**：`/gitmap -h` - 显示命令帮助信息

## 工作流程

1. 用户输入GitMap命令
2. 验证命令参数和项目路径
3. 启动scripts/gitdiagram/gitmap.sh脚本进行分析
4. 生成并保存项目解释和架构图
5. 显示结果并提供后续步骤建议

## 示例

<example>
用户: /gitmap

AI: GitMap - 项目结构分析与路线图生成工具

用法: /gitmap [选项] [项目路径]

选项:
  -h, --help            显示此帮助信息
  -o, --output DIR      指定输出目录，默认为.ai目录下的'gitmap_output'
  -i, --instructions TEXT   自定义分析指令，如'突出显示数据流'
  -k, --key KEY         指定OpenAI API密钥
  -r, --refactor        重构模式，分析已有项目并更新路线图

示例:
  /gitmap /path/to/project
  /gitmap -o ./diagrams -i '分析数据流' /path/to/project
  /gitmap -r /path/to/refactored/project

用户: /gitmap /Users/chenyi/Projects/myapp

AI: 正在分析项目: /Users/chenyi/Projects/myapp
输出目录: ./gitmap_output
模式: 标准分析

收集项目文件路径...
获取项目README内容...
开始分析项目结构...
正在生成项目解释...
正在生成组件映射...
正在生成架构图...
正在保存分析结果...
✅ 解释文件已保存至: /.ai/gitmap_output/project_explanation.md
✅ 架构图已保存至: /.ai/gitmap_output/project_diagram.md

分析完成! 📊
结果文件:
  - 项目解释: /.ai/gitmap_output/project_explanation.md
  - 架构图: /.ai/gitmap_output/project_diagram.md

💡 提示: 您可以使用Markdown查看器查看生成的文件，
   或将project_diagram.md中的图表代码粘贴到Mermaid在线编辑器进行查看和编辑。
   Mermaid在线编辑器: https://mermaid.live

项目架构图预览:
(架构图Mermaid预览)
</example>

<example type="invalid">
用户: /gitmap

AI: 您需要至少指定一个项目路径。例如：
/gitmap /path/to/your/project

您可以输入 /gitmap -h 获取详细帮助。

用户: /gitmap -z

AI: 错误: 未知选项 -z
请使用 /gitmap -h 查看可用选项。

用户: /gitmap /nonexistent/path

AI: 错误: 项目路径不存在或不是目录: /nonexistent/path
请检查路径是否正确。
</example>
